from fastapi import FastAPI
from fastapi.responses import JSONResponse
from database import engine
import models
from routers import router

# –°–æ–∑–¥–∞–µ–º —Ç–∞–±–ª–∏—Ü—ã
models.Base.metadata.create_all(bind=engine)

app = FastAPI(
    title="üèõÔ∏è –ú—É–∑–µ–π-–≤—ã—Å—Ç–∞–≤–∫–∞",
    description="""
    REST API –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –º—É–∑–µ–π–Ω—ã–º–∏ —ç–∫—Å–ø–æ–Ω–∞—Ç–∞–º–∏ –∏ –≤—ã—Å—Ç–∞–≤–∫–∞–º–∏
    
    –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:
    - üìä –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤–ª–∞–¥–µ–ª—å—Ü–∞–º–∏ —ç–∫—Å–ø–æ–Ω–∞—Ç–æ–≤
    - üñºÔ∏è –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —ç–∫—Å–ø–æ–Ω–∞—Ç–∞–º–∏ –∏ –∏—Ö —Ç–∏–ø–∞–º–∏  
    - üèõÔ∏è –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –º–µ—Å—Ç–∞–º–∏ –≤—ã—Å—Ç–∞–≤–æ–∫
    - üöö –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏—è–º–∏ —ç–∫—Å–ø–æ–Ω–∞—Ç–æ–≤
    - üìä –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
    
    –î–ª—è —É–¥–æ–±—Å—Ç–≤–∞:
    - Endpoint'—ã —Å–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞–Ω—ã –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
    - –ö–∞–∂–¥—ã–π endpoint –∏–º–µ–µ—Ç –æ–ø–∏—Å–∞–Ω–∏–µ
    - –û—Ç–≤–µ—Ç—ã —Å–æ–¥–µ—Ä–∂–∞—Ç –ø–æ–ª–µ `sql` —Å –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–º–∏ –∑–∞–ø—Ä–æ—Å–∞–º–∏ –∫ –ë–î
    """,
    version="1.0.1",
    license_info={
        "name": "@malsoft",
        "url": "https://opensource.org/licenses/MIT",
    }
)

# –ü–æ–¥–∫–ª—é—á–∞–µ–º –≤—Å–µ —Ä–æ—É—Ç–µ—Ä—ã
app.include_router(router, prefix="/api/v1", tags=["api"])

@app.get("/", tags=["üè† –ì–ª–∞–≤–Ω–∞—è"])
def read_root():
    return {
        "message": "–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ API –ú—É–∑–µ—è-–≤—ã—Å—Ç–∞–≤–∫–∏ –†–æ—Å—Å–∏–∏", 
        "docs": "/docs",
        "description": "–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ /docs –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ API"
    }

@app.get("/health", tags=["üîß –°–∏—Å—Ç–µ–º–∞"])
def health_check():
    """–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ API"""
    return {"status": "ok", "message": "API —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ"}